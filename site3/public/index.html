<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI SDK test program</title>
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <h1>AI SDK Test Program</h1>

    <div id="response" class="hidden"></div>
    <div class="test-form">
        <input id="promptInput" type="text" placeholder="Enter prompt" style="width: 100%;height: 40px;" />
        <button onclick="callLlm('oneshot')">One-shot</button><br />
        <button onclick="callLlm('streamtest')">Text streaming</button><br />
        <button onclick="callLlm('chat')">Chat completion</button>
    </div>
    <div id="results" class="hidden"></div>
    <p>This is a test project based on the
        <a href="https://www.aihero.dev/vercel-ai-sdk-tutorial" target="_blank">Vercel AI SDK tutorial</a>.
    </p>

<script>
        async function callLlm(method) {
            try {
                showResults('Loading...');
                let path = "";
                switch (method) {
                    case 'oneshot':
                        path = "/api/oneshot";
                        break;
                    case 'streamtest':
                        path = "/api/streamtest";
                        break;
                    case 'chat':
                        path = "/api/chat";
                        break;
                    default:
                        throw new Error('Unknown method: ' + method);
                }

                const prompt = document.getElementById('promptInput').value;
                const response = await fetch(`${path}?prompt=${encodeURIComponent(prompt)}`);
                const data = await response.json();

                showResults(JSON.stringify(data, null, 2));
                showResponse(data.completion);

            } catch (error) {
                showResults('Error: ' + error.message);
            }
        }

        function showResults(content) {
            const resultsDiv = document.getElementById('results');
            resultsDiv.textContent = content;
            resultsDiv.classList.remove('hidden');
        }

        function showResponse(text) {
            const responseDiv = document.getElementById('response');
            if (text) {
                responseDiv.textContent = text;
                responseDiv.classList.remove('hidden');
            } else {
                responseDiv.classList.add('hidden');
            }
        }
    </script>
</body>

</html>
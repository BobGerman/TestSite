<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI SDK test program</title>
    <link rel="stylesheet" href="styles.css">
    <script type="module" src="https://cdn.jsdelivr.net/npm/zero-md@3?register"></script>
</head>

<body>
    <h1>AI SDK Test Program</h1>

    <div class="test-form">
        <label for="userPromptInput">User Prompt:</label>
        <input id="userPromptInput" type="text" placeholder="Enter user prompt" style="width: 100%;height: 40px;" />
        <br />
        <label for="systemPromptInput">System Prompt:</label>
        <input id="systemPromptInput" type="text" placeholder="Enter system prompt" style="width: 100%;height: 40px;" />
        <br />
        <button onclick="callLlm('oneshot')">One-shot</button>
        <button onclick="callLlm('streamtest')">Text streaming</button>
        <button onclick="callLlm('chat')">Chat completion</button>
        <button onclick="callLlm('recipe')">Recipe generation</button>
    </div>
    <zero-md class="hidden">
        <script type="text/markdown" id="response"></script>
    </zero-md>
    <div id="results" class="hidden"></div>
    <p>This is a test project based on the
        <a href="https://www.aihero.dev/vercel-ai-sdk-tutorial" target="_blank">Vercel AI SDK tutorial</a>.
    </p>

    <script>
        async function callLlm(method) {
            try {
                showResults('');
                showResponse('Thinking ... ðŸ¤”');
                let path = "";
                switch (method) {
                    case 'oneshot':
                        path = "/api/oneshot";
                        break;
                    case 'streamtest':
                        path = "/api/streamtest";
                        break;
                    case 'chat':
                        path = "/api/chat";
                        break;
                    case 'recipe':
                        path = "/api/recipe";
                        break;
                    default:
                        throw new Error('Unknown method: ' + method);
                }

                const userPrompt = document.getElementById('userPromptInput').value;
                const systemPrompt = document.getElementById('systemPromptInput').value;
                const response = await fetch(
                    `${path}?userPrompt=${encodeURIComponent(userPrompt)}&systemPrompt=${encodeURIComponent(systemPrompt)}`
                );
                const data = await response.json();

                showResults(JSON.stringify(data, null, 2));
                showResponse(data.completion);

            } catch (error) {
                showResults('Error: ' + error.message);
            }
        }

        function showResults(content) {
            const resultsDiv = document.getElementById('results');
            resultsDiv.textContent = content;
            resultsDiv.classList.remove('hidden');
        }

        function showResponse(text) {
            const responseElement = document.getElementById('response');
            responseElement.textContent = text;
            const zeroMdElement = document.querySelector('zero-md');
            zeroMdElement.classList.remove('hidden');
        }
    </script>
</body>

</html>